\doxysection{WPR.\+Email.\+Reminders Class Referentie}
\hypertarget{class_w_p_r_1_1_email_1_1_reminders}{}\label{class_w_p_r_1_1_email_1_1_reminders}\index{WPR.Email.Reminders@{WPR.Email.Reminders}}


De klasse \doxylink{class_w_p_r_1_1_email_1_1_reminders}{Reminders} draaid op de achtergrond om elke 24 uur herrinering mails van contracten te sturen naar de benodigde gebruikers.  




Klasse diagram voor WPR.\+Email.\+Reminders
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=220pt]{class_w_p_r_1_1_email_1_1_reminders__inherit__graph}
\end{center}
\end{figure}


Collaboratie diagram voor WPR.\+Email.\+Reminders\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{class_w_p_r_1_1_email_1_1_reminders__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Members}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a31a0fa92259b7db6b6b7e0517ed63c9a}{Reminders}} (IService\+Provider service\+Provider, \mbox{\hyperlink{interface_w_p_r_1_1_database_1_1_i_connector}{IConnector}} connector)
\begin{DoxyCompactList}\small\item\em Constructor die de benodigde classes initialiseerd. \end{DoxyCompactList}\item 
virtual async Task$<$ bool $>$ \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a7444d93d984ea9038666a160d3f2c1cd}{Reminder\+Contract24\+Hours}} ()
\begin{DoxyCompactList}\small\item\em Alle gegevens worden opgehaald en verzameld om verstuurd te worden. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Members}
\begin{DoxyCompactItemize}
\item 
override async Task \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_ad80d4a26ca16bf220b8b188082e6fca3}{Execute\+Async}} (Cancellation\+Token stopping\+Token)
\begin{DoxyCompactList}\small\item\em Execute\+Async zorgt ervoor dat er de herinneringsmails elke x tijd verstuurd worden. Voor de realiteit is het per 24 uur. Voor het presenteren is het lke 10 seconden. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private Members}
\begin{DoxyCompactItemize}
\item 
string \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a1d75902f11e2e726605f7ffe7439944e}{Create\+Reminder\+Contract}} (Dictionary$<$ string, object $>$ \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_customer}{Customer}}, Dictionary$<$ string, object $>$ \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_contract}{Contract}}, Dictionary$<$ string, object $>$ \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_vehicle}{Vehicle}})
\begin{DoxyCompactList}\small\item\em Create\+Reminder\+Contract creeërt een standaard template voor het laten herinneren van gebruikers dat hun zij hun voertuig binnen 24 uur kunnen ophalen. \end{DoxyCompactList}\item 
async Task$<$ Dictionary$<$ string, object $>$ $>$ \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a42469c6c38c948b8fd2ae5960f5a5dd0}{Get\+Customer\+Info}} (int id, IService\+Scope scope)
\begin{DoxyCompactList}\small\item\em Alle gegevens van de klant worden verzameld. \end{DoxyCompactList}\item 
async Task$<$ Dictionary$<$ string, object $>$ $>$ \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a2e395400175836072d81ac325fd06141}{Get\+Contract\+Info}} (int id, IService\+Scope scope)
\begin{DoxyCompactList}\small\item\em Alle gegevens van het contract worden verzameld. \end{DoxyCompactList}\item 
async Task$<$ Dictionary$<$ string, object $>$ $>$ \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a67dff571812b76e4250e73684d8cc454}{Get\+Vehicle\+Info}} (int id, IService\+Scope scope)
\begin{DoxyCompactList}\small\item\em Alle gegegevens van het voertuig worden verzameld. \end{DoxyCompactList}\item 
async Task \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_aa5b68b714327d1e6ad8adae0698897f6}{Send\+Email}} (string body, string subject, string to\+Email, object order\+Id, IService\+Scope scope)
\begin{DoxyCompactList}\small\item\em Send\+Email zorgt voor de voorbereidingen van het maken van de email. Terwijl de email klaar wordt gemaakt om te verzenden wordt in de database geregistreerd dat er voor het huidige contract een herinnerings maal verzonden is. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Private Attributen}
\begin{DoxyCompactItemize}
\item 
readonly IService\+Provider \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a09689a320901679aa8ed84c220fed493}{\+\_\+service\+Provider}}
\item 
readonly \mbox{\hyperlink{interface_w_p_r_1_1_database_1_1_i_connector}{IConnector}} \mbox{\hyperlink{class_w_p_r_1_1_email_1_1_reminders_a48ebeeb8f8653fcbad7c2fd1845398d0}{\+\_\+connector}}
\end{DoxyCompactItemize}


\doxysubsection{Gedetailleerde Beschrijving}
De klasse \doxylink{class_w_p_r_1_1_email_1_1_reminders}{Reminders} draaid op de achtergrond om elke 24 uur herrinering mails van contracten te sturen naar de benodigde gebruikers. 

De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00017}{17}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.



\doxysubsection{Constructor \& Destructor Documentatie}
\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a31a0fa92259b7db6b6b7e0517ed63c9a}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!Reminders@{Reminders}}
\index{Reminders@{Reminders}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{Reminders()}{Reminders()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a31a0fa92259b7db6b6b7e0517ed63c9a} 
WPR.\+Email.\+Reminders.\+Reminders (\begin{DoxyParamCaption}\item[{IService\+Provider}]{service\+Provider}{, }\item[{\mbox{\hyperlink{interface_w_p_r_1_1_database_1_1_i_connector}{IConnector}}}]{connector}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor die de benodigde classes initialiseerd. 


\begin{DoxyParams}{Parameters}
{\em service\+Provider} & \\
\hline
{\em connector} & \\
\hline
\end{DoxyParams}

\begin{DoxyExceptions}{Excepties}
{\em Argument\+Null\+Exception} & \\
\hline
\end{DoxyExceptions}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00028}{28}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00029\ \ \ \ \ \{}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \_serviceProvider\ =\ serviceProvider\ ??\ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ ArgumentNullException(nameof(serviceProvider));}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \_connector\ =\ connector\ ??\ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ ArgumentNullException(nameof(connector));}
\DoxyCodeLine{00032\ \ \ \ \ \}}

\end{DoxyCode}


Gebruikt \mbox{\hyperlink{_reminders_8cs_source_l00020}{\+\_\+connector}} en \mbox{\hyperlink{_reminders_8cs_source_l00019}{\+\_\+service\+Provider}}.



\doxysubsection{Documentatie van functie members}
\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a1d75902f11e2e726605f7ffe7439944e}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!CreateReminderContract@{CreateReminderContract}}
\index{CreateReminderContract@{CreateReminderContract}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{CreateReminderContract()}{CreateReminderContract()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a1d75902f11e2e726605f7ffe7439944e} 
string WPR.\+Email.\+Reminders.\+Create\+Reminder\+Contract (\begin{DoxyParamCaption}\item[{Dictionary$<$ string, object $>$}]{Customer}{, }\item[{Dictionary$<$ string, object $>$}]{Contract}{, }\item[{Dictionary$<$ string, object $>$}]{Vehicle}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Create\+Reminder\+Contract creeërt een standaard template voor het laten herinneren van gebruikers dat hun zij hun voertuig binnen 24 uur kunnen ophalen. 


\begin{DoxyParams}{Parameters}
{\em \doxylink{class_w_p_r_1_1_email_1_1_customer}{Customer}} & \\
\hline
{\em \doxylink{class_w_p_r_1_1_email_1_1_contract}{Contract}} & \\
\hline
{\em \doxylink{class_w_p_r_1_1_email_1_1_vehicle}{Vehicle}} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retourneert}

\end{DoxyReturn}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00041}{41}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00042\ \ \ \ \ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ @\$\textcolor{stringliteral}{"{}<h1>Herinnering\ voor\ voertuig\ </h1>Beste\ \{Customer["{}}Email\textcolor{stringliteral}{"{}]\},}}
\DoxyCodeLine{00044\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ <p>Uw\ contract\ met\ referencie\ nummer\ \{Contract["{}}OrderId\textcolor{stringliteral}{"{}]\}\ gaat\ vanaf\ morgen\ in.</p>}}

\end{DoxyCode}
\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_ad80d4a26ca16bf220b8b188082e6fca3}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!ExecuteAsync@{ExecuteAsync}}
\index{ExecuteAsync@{ExecuteAsync}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{ExecuteAsync()}{ExecuteAsync()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_ad80d4a26ca16bf220b8b188082e6fca3} 
override async Task WPR.\+Email.\+Reminders.\+Execute\+Async (\begin{DoxyParamCaption}\item[{Cancellation\+Token}]{stopping\+Token}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Execute\+Async zorgt ervoor dat er de herinneringsmails elke x tijd verstuurd worden. Voor de realiteit is het per 24 uur. Voor het presenteren is het lke 10 seconden. 


\begin{DoxyParams}{Parameters}
{\em stopping\+Token} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retourneert}

\end{DoxyReturn}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00201}{201}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00211\ \ \ \ \ \{}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!stoppingToken.IsCancellationRequested)}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ ReminderContract24Hours();}

\end{DoxyCode}
\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a2e395400175836072d81ac325fd06141}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!GetContractInfo@{GetContractInfo}}
\index{GetContractInfo@{GetContractInfo}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{GetContractInfo()}{GetContractInfo()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a2e395400175836072d81ac325fd06141} 
async Task$<$ Dictionary$<$ string, object $>$ $>$ WPR.\+Email.\+Reminders.\+Get\+Contract\+Info (\begin{DoxyParamCaption}\item[{int}]{id}{, }\item[{IService\+Scope}]{scope}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Alle gegevens van het contract worden verzameld. 


\begin{DoxyParams}{Parameters}
{\em id} & \\
\hline
{\em scope} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retourneert}

\end{DoxyReturn}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00067}{67}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.

\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a42469c6c38c948b8fd2ae5960f5a5dd0}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!GetCustomerInfo@{GetCustomerInfo}}
\index{GetCustomerInfo@{GetCustomerInfo}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{GetCustomerInfo()}{GetCustomerInfo()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a42469c6c38c948b8fd2ae5960f5a5dd0} 
async Task$<$ Dictionary$<$ string, object $>$ $>$ WPR.\+Email.\+Reminders.\+Get\+Customer\+Info (\begin{DoxyParamCaption}\item[{int}]{id}{, }\item[{IService\+Scope}]{scope}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Alle gegevens van de klant worden verzameld. 


\begin{DoxyParams}{Parameters}
{\em id} & \\
\hline
{\em scope} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retourneert}

\end{DoxyReturn}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00052}{52}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.

\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a67dff571812b76e4250e73684d8cc454}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!GetVehicleInfo@{GetVehicleInfo}}
\index{GetVehicleInfo@{GetVehicleInfo}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{GetVehicleInfo()}{GetVehicleInfo()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a67dff571812b76e4250e73684d8cc454} 
async Task$<$ Dictionary$<$ string, object $>$ $>$ WPR.\+Email.\+Reminders.\+Get\+Vehicle\+Info (\begin{DoxyParamCaption}\item[{int}]{id}{, }\item[{IService\+Scope}]{scope}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Alle gegegevens van het voertuig worden verzameld. 


\begin{DoxyParams}{Parameters}
{\em id} & \\
\hline
{\em scope} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retourneert}

\end{DoxyReturn}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00082}{82}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.

\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a7444d93d984ea9038666a160d3f2c1cd}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!ReminderContract24Hours@{ReminderContract24Hours}}
\index{ReminderContract24Hours@{ReminderContract24Hours}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{ReminderContract24Hours()}{ReminderContract24Hours()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a7444d93d984ea9038666a160d3f2c1cd} 
virtual async Task$<$ bool $>$ WPR.\+Email.\+Reminders.\+Reminder\+Contract24\+Hours (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Alle gegevens worden opgehaald en verzameld om verstuurd te worden. 

\begin{DoxyReturn}{Retourneert}

\end{DoxyReturn}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00148}{148}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00158\ \ \ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{keyword}{using}\ (var\ scope\ =\ \_serviceProvider.CreateScope())\ \textcolor{comment}{//\ Er\ wordt\ een\ scope\ opgezet,\ zodat\ alle\ gegevens\ bereikbaar\ zijn}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ var\ customer\ =\ scope.ServiceProvider.GetRequiredService<ICustomerDetails>();}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ var\ contract\ =\ scope.ServiceProvider.GetRequiredService<IContractDetails>();}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ var\ vehicle\ =\ scope.ServiceProvider.GetRequiredService<IVehicleDetails>();}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ var\ contracts\ =\ scope.ServiceProvider.GetRequiredService<IContractRepository>();}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (customer\ ==\ \textcolor{keyword}{null}\ ||\ contract\ ==\ \textcolor{keyword}{null}\ ||\ vehicle\ ==\ \textcolor{keyword}{null}\ ||\ contracts\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Console.WriteLine(\textcolor{stringliteral}{"{}One\ or\ more\ required\ services\ are\ not\ available."{}});}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ IList<int>\ ids\ =\ await\ contracts.GetContractsSendEmailAsync();}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ids\ ==\ \textcolor{keyword}{null}\ ||\ ids.Count\ ==\ 0)}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Console.WriteLine(\textcolor{stringliteral}{"{}No\ contracts\ are\ waiting\ for\ an\ email"{}});}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\textcolor{keywordtype}{int}\ orderId\ \textcolor{keywordflow}{in}\ ids)}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Alle\ gegevens\ worden\ verzameld\ in\ dictionaries}}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dictionary<string,\ object>\ contractDic\ =\ \textcolor{keyword}{new}\ Dictionary<string,\ object>();}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dictionary<string,\ object>\ customerDic\ =\ \textcolor{keyword}{new}\ Dictionary<string,\ object>();}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Dictionary<string,\ object>\ vehicleDic\ =\ \textcolor{keyword}{new}\ Dictionary<string,\ object>();}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Alle\ gegevens\ worden\ in\ de\ dictionaries\ gezet}}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ contractDic\ =\ await\ GetContractInfo(orderId,\ scope);}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ customerDic\ =\ await\ GetCustomerInfo(Convert.ToInt32(contractDic[\textcolor{stringliteral}{"{}Customer"{}}]),\ scope);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vehicleDic\ =\ await\ GetVehicleInfo(Convert.ToInt32(contractDic[\textcolor{stringliteral}{"{}FrameNrVehicle"{}}]),\ scope);}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Email\ wordt\ aangemaakt}}

\end{DoxyCode}
\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_aa5b68b714327d1e6ad8adae0698897f6}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!SendEmail@{SendEmail}}
\index{SendEmail@{SendEmail}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{SendEmail()}{SendEmail()}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_aa5b68b714327d1e6ad8adae0698897f6} 
async Task WPR.\+Email.\+Reminders.\+Send\+Email (\begin{DoxyParamCaption}\item[{string}]{body}{, }\item[{string}]{subject}{, }\item[{string}]{to\+Email}{, }\item[{object}]{order\+Id}{, }\item[{IService\+Scope}]{scope}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}



Send\+Email zorgt voor de voorbereidingen van het maken van de email. Terwijl de email klaar wordt gemaakt om te verzenden wordt in de database geregistreerd dat er voor het huidige contract een herinnerings maal verzonden is. 


\begin{DoxyParams}{Parameters}
{\em body} & \\
\hline
{\em subject} & \\
\hline
{\em to\+Email} & \\
\hline
{\em order\+Id} & \\
\hline
{\em scope} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retourneert}

\end{DoxyReturn}

\begin{DoxyExceptions}{Excepties}
{\em Invalid\+Operation\+Exception} & \\
\hline
\end{DoxyExceptions}


De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00102}{102}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00112\ \ \ \ \ \{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ var\ emailService\ =\ scope.ServiceProvider.GetService<IEmailService>();\ \textcolor{comment}{//\ Emailservices\ wordt\ beschikbaargesteld}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (emailService\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidOperationException(\textcolor{stringliteral}{"{}IEmailService\ not\ found\ in\ service\ provider."{}});}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ query\ =\ \$\textcolor{stringliteral}{"{}UPDATE\ Contract\ SET\ SendEmail\ =\ 'Yes'\ WHERE\ OrderId\ =\ \{orderId\}"{}};}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Er\ wordt\ vastgesteld\ in\ de\ database\ dat\ er\ een\ email\ verstuurd\ is}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{using}\ (var\ connection\ =\ \_connector.CreateDbConnection())}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{using}\ (var\ command\ =\ connection.CreateCommand())}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ InvalidOperationException(\textcolor{stringliteral}{"{}Failed\ to\ create\ a\ database\ command."{}});}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ command.CommandText\ =\ query;}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (command.ExecuteNonQuery()\ >\ 0)}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ await\ emailService.Send(toEmail,\ subject,\ body);\ \textcolor{comment}{//\ Email\ aanvraag\ wordt\ verstuurd}}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (MySqlException\ ex)}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \{}

\end{DoxyCode}


Gebruikt \mbox{\hyperlink{_reminders_8cs_source_l00020}{\+\_\+connector}}.



\doxysubsection{Documentatie van data velden}
\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a48ebeeb8f8653fcbad7c2fd1845398d0}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!\_connector@{\_connector}}
\index{\_connector@{\_connector}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{\_connector}{\_connector}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a48ebeeb8f8653fcbad7c2fd1845398d0} 
readonly \mbox{\hyperlink{interface_w_p_r_1_1_database_1_1_i_connector}{IConnector}} WPR.\+Email.\+Reminders.\+\_\+connector\hspace{0.3cm}{\ttfamily [private]}}



De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00020}{20}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.



Wordt aangeroepen door \mbox{\hyperlink{_reminders_8cs_source_l00028}{Reminders()}} en \mbox{\hyperlink{_reminders_8cs_source_l00102}{Send\+Email()}}.

\Hypertarget{class_w_p_r_1_1_email_1_1_reminders_a09689a320901679aa8ed84c220fed493}\index{WPR.Email.Reminders@{WPR.Email.Reminders}!\_serviceProvider@{\_serviceProvider}}
\index{\_serviceProvider@{\_serviceProvider}!WPR.Email.Reminders@{WPR.Email.Reminders}}
\doxysubsubsection{\texorpdfstring{\_serviceProvider}{\_serviceProvider}}
{\footnotesize\ttfamily \label{class_w_p_r_1_1_email_1_1_reminders_a09689a320901679aa8ed84c220fed493} 
readonly IService\+Provider WPR.\+Email.\+Reminders.\+\_\+service\+Provider\hspace{0.3cm}{\ttfamily [private]}}



De definitie bevindt zich op regel \mbox{\hyperlink{_reminders_8cs_source_l00019}{19}} in het bestand \mbox{\hyperlink{_reminders_8cs_source}{Reminders.\+cs}}.



Wordt aangeroepen door \mbox{\hyperlink{_reminders_8cs_source_l00028}{Reminders()}}.



De documentatie voor deze klasse is gegenereerd op basis van het volgende bestand\+:\begin{DoxyCompactItemize}
\item 
D\+:/codes/\+WPR8/\+WPR/backend/src/\+Emails/\mbox{\hyperlink{_reminders_8cs}{Reminders.\+cs}}\end{DoxyCompactItemize}
